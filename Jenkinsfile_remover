pipeline {

    agent any
    environment {

        TELEGRAM_TOKEN = credentials('telegram-token') // change this line with your credential id for Telegram bot access token
        TELEGRAM_CHAT_ID = 389929520 // change this line with your credential id for Telegram bot chat id

        TEXT_PRE_BUILD = "Jenkins is building ${JOB_NAME}"
        TEXT_SUCCESS_BUILD = "${JOB_NAME} is Success"
        TEXT_FAILURE_BUILD = "${JOB_NAME} is Failure"
        TEXT_ABORTED_BUILD = "${JOB_NAME} is Aborted"
      }
    stages {

        stage("Interactive_Input") {
            steps {
                //sh 'echo $(env)'
                telegramSend(message: "Choose required", chatId: "${env.TELEGRAM_CHAT_ID}")
                script {

                    // Variables for input
                    def inputConfig
                    def inputTest

                    // Get the input
                    def userInput = input(
                            id: 'userInput', message: "Branch ${SOURCE_BRANCH_NAME} is deleted are we remove it from kuber?",
                            parameters: [

                                    string(defaultValue: 'None',
                                            description: 'Path of config file',
                                            name: 'Config'),
                                    string(defaultValue: 'None',
                                            description: 'Test Info file',
                                            name: 'Test'),
                            ])

                    // Save to variables. Default to empty string if not found.
                    inputConfig = userInput.Config?:''
                    inputTest = userInput.Test?:''

                    // Echo to console
                    echo("IQA Sheet Path: ${inputConfig}")
                    echo("Test Info file path: ${inputTest}")

                    // Write to file
                    //writeFile file: "inputData.txt", text: "Config=${inputConfig}\r\nTest=${inputTest}"

                    // Archive the file (or whatever you want to do with it)
                    //archiveArtifacts 'inputData.txt'
                }


            }
        }
    }
    post{
          success{
               //telegramSend(message: 'Hello World', chatId: 389929520)
                  sh "curl -s -X POST https://api.telegram.org/bot${env.TELEGRAM_TOKEN}/sendMessage -d chat_id='${env.TELEGRAM_CHAT_ID}' -d text='${env.TEXT_SUCCESS_BUILD}'"
          }
          /*failure{
               //telegramSend(message: 'Hello World', chatId: 389929520)
               sh "curl -s -X POST https://api.telegram.org/bot${env.TELEGRAM_TOKEN}/sendMessage -d chat_id=${env.TELEGRAM_CHAT_ID} -d text=${env.TEXT_SUCCESS_BUILD}"
          }
          aborted{
               //telegramSend(message: 'Hello World', chatId: 389929520)
              sh ''' curl -s -X POST https://api.telegram.org/bot"${env.TELEGRAM_TOKEN}"/sendMessage -d chat_id="$TELEGRAM_CHAT_ID" -d text="${env.TEXT_FAILURE_BUILD}" '''
          }*/

  }
}